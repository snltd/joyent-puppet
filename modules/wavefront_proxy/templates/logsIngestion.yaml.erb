---
aggregationIntervalSeconds: 5

counters:
  - pattern: '%{WORD:vhost}.%{NOTSPACE:domain} %{IPORHOST:clientip} \[%{HTTPDATE:timestamp}\] \"%{WORD:verb} %{NOTSPACE:path} HTTP/%{NUMBER:httpversion}\" %{NUMBER:response} %{NUMBER:bytes} %{NUMBER:latency_ms}'
    metricName: 'caddy.code.%{response}'
    tagKeys:
      - vhost
      - path
      - httpversion
    tagValueLabels:
      - vhost
      - path
      - httpversion

histograms:
  - pattern: '%{WORD:vhost}.%{NOTSPACE:domain} %{IPORHOST:clientip} \[%{HTTPDATE:timestamp}\] \"%{WORD:verb} %{NOTSPACE:path} HTTP/%{NUMBER:httpversion}\" %{NUMBER:response} %{NUMBER:bytes} %{NUMBER:value}'
    metricName: caddy.latency
    tagKeys:
      - vhost
      - path
      - httpversion
    tagValueLabels:
      - vhost
      - path
      - httpversion
